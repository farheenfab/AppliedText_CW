 to kick rocks (it's an American expression) = to tell someone rudely to go away. 
To lose one's marbles = to lose one's mind.